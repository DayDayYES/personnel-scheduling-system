# 开卡数据可视化功能使用说明

## 🎉 功能概述

在工序管理界面添加了**开卡数据查看**功能，可以像Excel表格一样展示已导入的管道开卡数据，支持搜索、分页、删除等操作。

---

## 📊 功能特点

### ✅ 已实现的功能

1. **双标签页切换**
   - 工序管理：原有的工序管理功能
   - 开卡数据查看：新增的开卡数据可视化功能

2. **Excel风格展示**
   - 表格样式与导入的Excel完全一致
   - 18列数据：管道序号、管道编号 + 16个工序
   - 工序列包括：搭架子、拆保温、打磨、宏观检查、壁厚测定、RT检测、MT检测、PT检测、UT检测、其他无损检测、硬度检测、金相检测、铁素体检测、检验结果评定、返修、返修结果确认

3. **数据展示**
   - 有值的单元格：显示数字，带渐变色
   - 无值的单元格：显示 "-"，灰色斜体
   - 固定列：管道序号和管道编号固定在左侧
   - 固定操作列：删除按钮固定在右侧

4. **搜索功能**
   - 按管道编号模糊搜索
   - 按状态筛选（待处理/处理中/已完成）
   - 重置按钮快速清空搜索条件

5. **分页功能**
   - 支持10/20/50/100条每页
   - 页码跳转
   - 总记录数显示

6. **删除功能**
   - 单条删除：每行的删除按钮
   - 批量删除：选择多行后批量删除
   - 删除前二次确认

7. **实时统计**
   - 顶部Badge显示总记录数
   - 表格上方显示总记录数

---

## 🚀 使用步骤

### 第一步：导入Excel数据

1. 点击页面右上角的**"导入开卡Excel"**按钮
2. 选择Excel文件上传
3. 等待导入完成

### 第二步：查看开卡数据

1. 点击顶部的**"开卡数据查看"**标签页
2. 系统自动加载并展示所有导入的数据
3. 表格以Excel风格展示，包含所有16个工序列

### 第三步：搜索和筛选

**按管道编号搜索：**
```
输入管道编号（如：AV-32130）→ 点击"查询"按钮
```

**按状态筛选：**
```
选择状态（待处理/处理中/已完成）→ 点击"查询"按钮
```

**重置搜索：**
```
点击"重置"按钮 → 清空所有搜索条件，显示全部数据
```

### 第四步：删除数据

**删除单条记录：**
```
找到要删除的行 → 点击右侧"删除"按钮 → 确认删除
```

**批量删除：**
```
勾选多行 → 点击顶部"批量删除 (N)"按钮 → 确认删除
```

---

## 📋 界面说明

### 主界面布局

```
┌─────────────────────────────────────────────┐
│  页面标题区域                                 │
│  [导入开卡Excel] [新增工序]                   │
└─────────────────────────────────────────────┘
┌─────────────────────────────────────────────┐
│  主标签页                                     │
│  ┌──────────┬──────────────┐               │
│  │工序管理  │ 开卡数据查看  │  ← 点击切换    │
│  └──────────┴──────────────┘               │
└─────────────────────────────────────────────┘
┌─────────────────────────────────────────────┐
│  搜索区域                                     │
│  管道编号：[_______] 状态：[____]            │
│  [查询] [重置]                                │
└─────────────────────────────────────────────┘
┌─────────────────────────────────────────────┐
│  数据表格区域                                 │
│  管道开卡数据 共 50 条记录                    │
│  [批量删除 (0)]                               │
│  ┌──┬────┬─────┬────┬───┬───┐           │
│  │☐│序号│编号 │工序1│... │操作│           │
│  ├──┼────┼─────┼────┼───┼───┤           │
│  │☐│ 1  │AV...│ 1  │ - │删除│           │
│  │☐│ 2  │BD...│ -  │ 2 │删除│           │
│  └──┴────┴─────┴────┴───┴───┘           │
│  [分页控件]                                   │
└─────────────────────────────────────────────┘
```

### 表格列说明

| 列序号 | 列名 | 宽度 | 说明 |
|-------|------|------|------|
| - | 选择框 | 55px | 用于批量操作 |
| 1 | 管道序号 | 100px | 固定左侧，带标签 |
| 2 | 管道编号 | 150px | 固定左侧，加粗显示 |
| 3 | 搭架子 | 100px | 工序1 |
| 4 | 拆保温 | 100px | 工序2 |
| 5 | 打磨 | 100px | 工序3 |
| 6 | 宏观检查 | 100px | 工序4 |
| 7 | 壁厚测定 | 100px | 工序5 |
| 8 | RT检测 | 100px | 工序6 |
| 9 | MT检测 | 100px | 工序7 |
| 10 | PT检测 | 100px | 工序8 |
| 11 | UT检测 | 100px | 工序9 |
| 12 | 其他无损检测 | 120px | 工序10 |
| 13 | 硬度检测 | 100px | 工序11 |
| 14 | 金相检测 | 100px | 工序12 |
| 15 | 铁素体检测 | 120px | 工序13 |
| 16 | 检验结果评定 | 120px | 工序14 |
| 17 | 返修 | 100px | 工序15 |
| 18 | 返修结果确认 | 120px | 工序16 |
| - | 操作 | 120px | 固定右侧，删除按钮 |

---

## 🎨 视觉效果

### 样式特点

1. **主标签页**
   - 渐变紫色背景（#667eea → #764ba2）
   - 激活标签高亮显示
   - 平滑过渡动画

2. **表格样式**
   - 带边框的Excel风格
   - 斑马纹（隔行变色）
   - 固定高度600px，可滚动

3. **单元格样式**
   - 有值：渐变紫色文字，加粗显示
   - 无值：灰色 "-"，斜体显示

4. **交互效果**
   - 鼠标悬停高亮
   - 按钮点击反馈
   - 平滑的切换动画

---

## 💾 数据格式

### Excel原始数据

```
管道序号 | 管道编号  | 搭架子 | 拆保温 | ... | 返修结果确认
   1    | AV-32130 |   1   |   1   | ... |     1
   2    | BD-32031 |   1   |   1   | ... |     1
```

### 数据库存储

**主表 (pipeline_card):**
```
id | card_no | pipeline_code | status  | create_time
 1 |    1    |   AV-32130   | pending | 2025-01-16
 2 |    2    |   BD-32031   | pending | 2025-01-16
```

**明细表 (pipeline_card_process):**
```
id | card_id | process_name | process_code | required_count | process_order
 1 |    1    |   搭架子     | scaffold     |       1        |      3
 2 |    1    |   拆保温     | remove_ins.. |       1        |      4
...
```

### 接口返回数据（扁平化）

```json
{
  "code": 200,
  "data": {
    "data": [
      {
        "id": 1,
        "cardNo": "1",
        "pipelineCode": "AV-32130",
        "status": "pending",
        "scaffold": "1",
        "remove_insulation": "1",
        "grinding": "1",
        "macro_inspection": "1",
        "thickness_test": "1",
        "rt_test": null,
        "mt_test": null,
        ...
      }
    ],
    "total": 50,
    "pageNum": 1,
    "pageSize": 20
  }
}
```

---

## 🔧 技术实现

### 前端技术栈

- **Vue.js 2.x**：框架
- **Element UI**：UI组件库
- **Axios**：HTTP请求

### 后端技术栈

- **Spring Boot**：后端框架
- **MyBatis-Plus**：ORM框架
- **MySQL**：数据库

### 核心功能

1. **数据查询接口**
   ```
   POST /pipelineCard/listPageFlat
   - 分页查询
   - 管道编号模糊搜索
   - 状态筛选
   - 数据扁平化处理
   ```

2. **删除接口**
   ```
   DELETE /pipelineCard/delete/{id}  - 单条删除
   POST /pipelineCard/deleteBatch     - 批量删除
   ```

3. **前端组件**
   ```vue
   - 主标签页切换
   - Excel风格表格展示
   - 搜索和分页控制
   - 批量操作处理
   ```

---

## ⚠️ 注意事项

1. **数据量限制**
   - 建议每页不超过100条记录
   - 大数据量时使用搜索功能

2. **删除操作**
   - 删除操作不可恢复
   - 删除主表记录时，会级联删除所有工序明细

3. **浏览器兼容性**
   - 推荐使用Chrome、Edge、Firefox等现代浏览器
   - 表格横向滚动在小屏幕上可能需要手动拖动

4. **数据刷新**
   - 导入新数据后，需要切换到"开卡数据查看"标签页查看
   - 删除后自动刷新列表

---

## 📈 未来扩展

可能的功能扩展方向：

1. **数据导出**
   - 导出为Excel
   - 导出为PDF

2. **数据编辑**
   - 在线编辑单元格
   - 批量修改状态

3. **数据统计**
   - 各工序的需求统计
   - 管道类型分布图表

4. **与调度系统集成**
   - 一键生成调度任务
   - 查看调度结果

---

## 🎯 使用示例

### 示例1：查看所有数据

```
1. 点击"开卡数据查看"标签
2. 默认显示所有数据，分页展示
3. 可通过分页控件浏览所有记录
```

### 示例2：搜索特定管道

```
1. 在"管道编号"输入框输入：BD-
2. 点击"查询"按钮
3. 显示所有编号包含"BD-"的管道
```

### 示例3：批量删除测试数据

```
1. 勾选前10行数据
2. 点击"批量删除 (10)"按钮
3. 在弹出的确认框点击"确定"
4. 数据被删除，列表自动刷新
```

---

## 📞 技术支持

如有问题，请检查：
1. 数据库中是否有数据（pipeline_card表）
2. 后端服务是否正常运行
3. 浏览器控制台是否有错误信息
4. 网络请求是否成功

---

**最后更新时间：** 2025-01-16

**版本：** v1.0

